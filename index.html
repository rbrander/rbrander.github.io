<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>Login</title>
		<link rel="stylesheet" type="text/css" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
		<script src='https://cdn.firebase.com/js/client/1.0.17/firebase.js'></script>
		<script type='text/javascript' src='https://cdn.firebase.com/js/simple-login/1.6.1/firebase-simple-login.js'></script>
		<script src="jquery-2.1.1.min.js"></script>
		<script type="text/javascript">
			
			if (document.location.protocol != 'https:' && document.location.hostname != 'localhost')
				window.location.replace('https:'+document.location.href.slice(document.location.protocol.length));
		
			var $j = jQuery;
			var url = "https://scorching-fire-8816.firebaseio.com/";
			var auth;
			var db;
			
			
			$j(function() {
				db = new Firebase(url);
				auth = new FirebaseSimpleLogin(db, function(error, user) {
					if (error) {
						// an error occurred while attempting login
						console.log(error);
					} else if (user) {
						// user authenticated with Firebase
						console.log('User ID: ' + user.uid + ', Provider: ' + user.provider);
						console.dir(user);
						/*
							github user has:
							- id, uid, displayName, username, provider, thirdPartyUserData.avatar_url
						*/
						// save user
						db = new Firebase(url + 'users');
						db.push(user);
						location.href = '/home.html';
					} else {
						// user is logged out
						console.log('user is logged out');
						//auth.login('github');
					}
				});
				// auth.logout();
				// auth.login('<provider>');
			});
				
			function login(provider)
			{
				auth.login(provider);
			}
			
			/*
			function dologin()
			{
				var username = $j('#txtUsername').val();
				var password = $j('#txtPassword').val();
				
				
				alert('u: '+username+'   p: '+password);
				
				store(username, password);
			}
			
			function isValid(user, pass)
			{
				db = new Firebase(url);
				db.on('value', function(snapshot) {
					var users = snapshot.val();
					
				});
			}
			
			function store(user, pass)
			{
				db = new Firebase(url+'user');
				db.set({user: user, password: pass});
			}
			*/
			
			/*
			var url = "https://scorching-fire-8816.firebaseio.com/";
			var db = new Firebase(url);
			
			var myDataRef = new Firebase(url);
			myDataRef.set('User ' + name + ' says ' + text);
			myDataRef.set({name: name, text: text});
			myDataRef.push({name: name, text: text});
			
			myDataRef.on('child_added', function(snapshot) {
				var message = snapshot.val();
				displayChatMessage(message.name, message.text);
			});
			

			*/
		</script>
	</head>
	<body>
		<h1>Login</h1>
		<div>
			<button type="button" onclick="login('google')">Google</button>
			<button type="button" onclick="login('github')">Github</button>
		</div>
	</body>
</html>